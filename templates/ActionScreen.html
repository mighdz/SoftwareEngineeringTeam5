<!DOCTYPE html>
<html lang="en" id = "next";>
	<head>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<title>Game Action Screen</title>
	</head>
	<style>
		* {
			box-sizing: border-box;
		}
		
		.box1 {
			border-radius: 25px;
			height: 375px; 
			border: 2px solid lightgray;
			padding: 3px;			
		}
		
/* 		.box2 { 
			width: 110px; 
			height: 85px; 
			border: 1px solid lightgray;
			text-align:center;
			padding: 3px;
		} */
		
		.box3 {
			border-radius: 25px;
			height: 250px; 
			border: 2px solid lightgray;
			background: dimgray;
			padding: 3px;			
		}
		
		.column {
			float: left;
			width: 50%;
			padding: 3px;
		}
		
		.column2 {
			float: left;
			width: 8.33%;
			padding: 3px;
		}
		
		.row::after {
			content: "";
			clear: both;
			display: table;
		}
		
		h2 {
			padding: 5px;
			margin: 0px;
		}
		
		h3 {
			padding: 5px;
			margin: 0px;
		}
	</style>
	<div class="btnGroup">
        <span class="timer">
          <span id="counter"></span>
        </span>
      </div>

      <style>
      	.btnGroup{
      		color: white;
      		text-align: center;
      		font-size: 60px;
      	}
      </style>

      <script>
      	function countdown() {
        var seconds = 31;
	var minutes = 0;
        var check = false;
        function tick() {
          var counter = document.getElementById("counter");
          seconds--;
          counter.innerHTML =
            minutes + ":" + (seconds < 10 ? "0" : "") + String(seconds);
	  while(minutes >= 0)
	  {
               if (seconds > 0) {
		    setTimeout(tick, 1000);
		  }
         if (minutes == 0 && seconds == 0 && check == false) {
              minutes = 5;
              seconds = 60;
              check = true;
           }
              else if (seconds == 0 && check == true) {
              minutes--;
              seconds = 60;
      	          }
		  else {
		   		document.getElementById("verifiBtn").innerHTML = `
				<div class="Btn" id="ResendBtn">
					<button type="submit">Resend</button>
				</div>
				`;
			}
		}
	}
}
			</script>

	
	
	
<body style="background-color:black">
		
	<!-- Scores Header -->
	<div class ="row">
		<h2 style="color:white"> &emsp; Current Scores </h1>
	</div>
	
	<!-- Scores Box -->
	<div class="box1" style="color:white">
		<div class ="row">
		
			<div class="column">
				<center>
				
				<!-- Red Team Name -->
				<h2>RED TEAM</h2>
				
				</center>
			</div>
			
			<div class="column">
				<center>
				
				<!-- Green Team Name -->
				<h2>GREEN TEAM</h2>
				
				</center>
			</div>
		</div>

			<div class ="row" style="font-size:115%">
			
				<div class="column" style="color:firebrick">
				
					<div class="column" style="text-align:center">
					<!-- Red Players -->
					<div id = 'red1ID' style="float:left"></div>
					<div id = 'red1Code' style="float:left"></div><br>
					<div id = 'red2ID' style="float:left"></div>
					<div id = 'red2Code' style="float:left"></div><br>
					<div id = 'red3ID' style="float:left"></div>
					<div id = 'red3Code' style="float:left"></div><br>
					<div id = 'red4ID' style="float:left"></div>
					<div id = 'red4Code' style="float:left"></div><br>
					<div id = 'red5ID' style="float:left"></div>
					<div id = 'red5Code' style="float:left"></div><br>
					<div id = 'red6ID' style="float:left"></div>
					<div id = 'red6Code' style="float:left"></div><br>
					<div id = 'red7ID' style="float:left"></div>
					<div id = 'red7Code' style="float:left"></div><br>
					<div id = 'red8ID' style="float:left"></div>
					<div id = 'red8Code' style="float:left"></div><br>
					<div id = 'red9ID' style="float:left"></div>
					<div id = 'red9Code' style="float:left"></div><br>
					<div id = 'red10ID' style="float:left"></div>
					<div id = 'red10Code' style="float:left"></div><br>
					<div id = 'red11ID' style="float:left"></div>
					<div id = 'red11Code' style="float:left"></div><br>
					<div id = 'red12ID' style="float:left"></div>
					<div id = 'red12Code' style="float:left"></div><br>
					<div id = 'red13ID' style="float:left"></div>
					<div id = 'red13Code' style="float:left"></div><br>
					<div id = 'red14ID' style="float:left"></div>
					<div id = 'red14Code' style="float:left"></div><br>
					<div id = 'red15ID' style="float:left"></div>
					<div id = 'red15Code' style="float:left"></div><br>
					</div>
					
					<div class="column" style="text-align:center">
					<!-- Red Player 1 Score -->
					<h3 id = "red1Score"></h3>
					
					<!-- Red Player 2 Score -->
					<h3 id = "red2Score"></h3>
					
					<!-- Add Remaining Player Scores -->
					</div>
					
				</div>
				
				<div class="column" style="color:seagreen">
					
					<div class="column" style="text-align:center">
					<!-- Green Players -->
					<div id = 'green1ID' style="float:left"></div>
					<div id = 'green1Code' style="float:left"></div><br>
					<div id = 'green2ID' style="float:left"></div>
					<div id = 'green2Code' style="float:left"></div><br>
					<div id = 'green3ID' style="float:left"></div>
					<div id = 'green3Code' style="float:left"></div><br>
					<div id = 'green4ID' style="float:left"></div>
					<div id = 'green4Code' style="float:left"></div><br>
					<div id = 'green5ID' style="float:left"></div>
					<div id = 'green5Code' style="float:left"></div><br>
					<div id = 'green6ID' style="float:left"></div>
					<div id = 'green6Code' style="float:left"></div><br>
					<div id = 'green7ID' style="float:left"></div>
					<div id = 'green7Code' style="float:left"></div><br>
					<div id = 'green8ID' style="float:left"></div>
					<div id = 'green8Code' style="float:left"></div><br>
					<div id = 'green9ID' style="float:left"></div>
					<div id = 'green9Code' style="float:left"></div><br>
					<div id = 'green10ID' style="float:left"></div>
					<div id = 'green10Code' style="float:left"></div><br>
					<div id = 'green11ID' style="float:left"></div>
					<div id = 'green11Code' style="float:left"></div><br>
					<div id = 'green12ID' style="float:left"></div>
					<div id = 'green12Code' style="float:left"></div><br>
					<div id = 'green13ID' style="float:left"></div>
					<div id = 'green13Code' style="float:left"></div><br>
					<div id = 'green14ID' style="float:left"></div>
					<div id = 'green14Code' style="float:left"></div><br>
					<div id = 'green15ID' style="float:left"></div>
					<div id = 'green15Code' style="float:left"></div><br>
					</div>
					
					<div class="column" style="text-align:center">
						<!-- Green Player 1 Score -->
						<h3 id = "green3Score"></h3>
						
						<!-- Green Player 2 Score -->
						<h3 id = "green4Score"></h3>
					</div>
					
				</div>
				
			</div>
			
		</div>
		
		<!-- Action Header -->
		<div class ="row">
			<h2 style="color:white"> &emsp; Current Game Action </h2>
		</div>
		
		<!-- Action Box -->
		<div class="box3" style="color:white">
			<center><h3 id="event" style="color:royalblue;"></h3></center>
		</div>

		<script>

	//Set countdown to 30 seconds
	var countDownTime = 10;
	var countDownTime2 = 370;

	//Create variables to show events
	var numEvents = -1;
 	var i = 0;

	//Find where the countdown is supposed to be
	var event = document.getElementById('event');
	var r1Score = document.getElementById('red1Score');
	var r2Score = document.getElementById('red2Score');
	var g3Score = document.getElementById('green3Score');
	var g4Score = document.getElementById('green4Score');

	//Function for every 1 second to print the count
	var time = setInterval(function() {
		//Print countdown timer if time is positive //all members helped with this part
		if (countDownTime >= 0){
			event.innerHTML = countDownTime + ' seconds remaining until game starts';
			counter.innerHTML = countDownTime2;
			countDownTime = countDownTime - 1;
			countDownTime2 = countDownTime2 - 1;
		}
		//Tell user game has started
		else if(countDownTime == -1){
			event.innerHTML = "Game Start!";
			countDownTime = countDownTime - 1;
			countDownTime2 = countDownTime2 - 1;
			numEvents = (eventsLen) * 5;
		}
		else if(numEvents > 0 && (countDownTime2 <= 360)) {
			if (i < eventsLen){

				if(String(events[i]) == "1 shot 3") {
					event.innerHTML = "Red player 1 shot Green player 3";
					r1Score += 1;
					red1Score.innerHTML = r1Score;
				}
				else if(String(events[i]) == "1 shot 4") {
					event.innerHTML = "Red player 1 shot Green player 4";
					r1Score += 1;
					red1Score.innerHTML = r1Score;
				}
				else if(String(events[i]) == "2 shot 3") {
					event.innerHTML = "Red player 2 shot Green player 3";
					r2Score += 1;
					red2Score.innerHTML = r2Score;
				}
				else if(String(events[i]) == "2 shot 4") {
					event.innerHTML = "Red player 2 shot Green player 4";
					r2Score += 1;
					red2Score.innerHTML = r2Score;
				}
				else if(String(events[i]) == "3 shot 1") {
					event.innerHTML = "Green player 3 shot Red player 1";
					g3Score += 1;
					green3Score.innerHTML = g3Score;
				}
				else if(String(events[i]) == "3 shot 2") {
					event.innerHTML = "Green player 3 shot Red player 2";
					g3Score += 1;
					green3Score.innerHTML = g3Score;
				}
				else if(String(events[i]) == "4 shot 1") {
					event.innerHTML = "Green player 4 shot Red player 1";
					g4Score += 1;
					green4Score.innerHTML = g4Score;
				}
				else if(String(events[i]) == "4 shot 2") {
					event.innerHTML = "Green player 4 shot Red player 2";
					g4Score += 1;
					green4Score.innerHTML = g4Score;
				}
				numEvents -= 1;
				testVar = numEvents % 5;
				if(testVar == 0){
					i += 1;
				}
			}
			countDownTime2 = CountDownTime2 - 1;
		}
		else{
			red_points = red1Score + red2Score;
			green_points = green3Score + green4Score;
			final_score = "Red points: " + red_points + " vs  " + "Green points: " + green_points;
			event.innerHTML = final_score;
			countDownTime = countDownTime - 1;
			countDownTime2 = countDownTime2 - 1;
		}
	}, 1000);

	  setTimeout(function loadPlayers() {
		request = new XMLHttpRequest();

		request.open('GET', '/getPlayers',true);

		request.responseType = 'json';

		request.send();

		request.onload = function(){
			let requestObj = request.response;

			var red1ID = requestObj.red1ID;
			if (red1ID != null)
				document.getElementById('red1ID').innerHTML = red1ID;

			var red2ID = requestObj.red2ID;
			if (red2ID != null)
				document.getElementById('red2ID').innerHTML = red2ID;

			var red1Code = requestObj.red1Code;
			if (red1Code != null)
				document.getElementById('red1Code').innerHTML = red1Code;

			var red2Code = requestObj.red2Code;
			if (red2Code != null)
				document.getElementById('red2Code').innerHTML = red2Code;

			var green1ID = requestObj.green1ID;
			if (green1ID != null)
				document.getElementById('green1ID').innerHTML = green1ID;

			var green2ID = requestObj.green2ID;
			if (green2ID != null)
				document.getElementById('green2ID').innerHTML = green2ID;

			var green1Code = requestObj.green1Code;
			if (green1Code != null)
				document.getElementById('green1Code').innerHTML = green1Code;

			var green2Code = requestObj.green2Code;
			if (green2Code != null)
				document.getElementById('green2Code').innerHTML = green2Code;
			
				var ListOfEvents = requestObj.events;
				tempLen = ListOfEvents.length;
				ListOfEvents = ListOfEvents.slice(2);
				ListOfEvents = ListOfEvents.substr(0, tempLen - 1);
				events = ListOfEvents.split(" , ");
				eventsLen = events.length;
				console.log(events)

				redPoints = requestObj.redPoints;
				let redLen = redPoints.length;
				redPoints = redPoints.substr(0, redLen - 1);
				redPoints = redPoints.slice(2);

				greenPoints = requestObj.greenPoints;
				let greenLen = greenPoints.length;
				greenPoints = greenPoints.substr(0, greenLen - 1);
				greenPoints = greenPoints.slice(2);
		}
	  }, 5000);

      </script>

			
		
	
	</body>
</html>
